# TIPMOC (TIpping via Powerâ€‘law fits and MOdel Comparison)

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

This repository contains the implementation of **TIPMOC**, a framework for detecting tipping points using power-law fits and model comparison. It includes all code necessary to reproduce the figures and tables presented in the manuscript.

> **Citation:** > Author names. (Year). *Paper Title*. Journal Name. [DOI link]

---

## ðŸš€ Getting Started

### Prerequisites
* Python 3.x
* Required libraries: `numpy`, `pandas`, `matplotlib`, `scipy`

---

## ðŸ›  Code Reference

### Core TIPMOC Functions
| File | Description |
| :--- | :--- |
| `fit_powerlaw.py` | Fits the specific power-law diverging function to a sequence of ($u$, $\hat{V}$). |
| `delta_aicc.py` | Computes $\Delta \text{AIC}_{\text{c}}$ (difference between linear and power-law fits). |

### Simulation Runners
| File | System / Model |
| :--- | :--- |
| `run_double_well.py` | Double-well dynamical system. |
| `run_over_harvesting.py` | Over-harvesting models (Kefi et al., 2013). |
| `run_mutualistic.py` | Mutualistic-interaction model on a network. |
| `run_ou.py` | Ornstein-Uhlenbeck process. |
| `test_tipmoc_100_1.py` | Batch runner to produce data for Figures 2(a), 2(b), and Table 1. |

### Visualization & Analysis
| File | Figure Produced |
| :--- | :--- |
| `explain_tipmoc.py` | Schematic (Figure 1). |
| `one_run_plot_using_given_data.py` | Fine-tuned Figures 2(a) and 2(b). |
| `sample-plot-using-given-data.py` | Fine-tuned Figures 2(c) and 4. |
| `plot_hatuc_scatter_dw.py` | Diagnostic scattergrams (Figures 3(a) and 3(b)). |
| `diagnostic_analysis.py` | Summary statistics for Table 1. |

### Auxiliary Scripts
* `bifu_pt_double_well.py`: Determines bifurcation point (3.079) for the double-well system.
* `bifu_pt_mutualistic.py`: Determines collapse point (0.0470) for the mutualistic system.

---

## ðŸ“Š Data Files

### Network Data
* `LFR.csv`: LFT network used in mutualistic-interaction simulations. This network is identical to the one used in [Maclaren et al. (2023)](https://doi.org/10.1098/rsif.2022.0743).

### Numerically Simulated Data (in `data_for_fig/`)
* **Figures 2(a, b):** `last_trial_raw_data_dw.csv`
* **Figure 2(c):** `detection_summary-dw.csv`, `sample_variance_trials-dw.csv`
* **Figure 3:** `all_runs_result_dw.csv`
* **Figure 4:**
  * `detection_summary-{overharvestingK10, lineargrazing, rosenzweig, mutualistic}.csv`
  * `sample_variance_trials-{overharvestingK10, lineargrazing, rosenzweig, mutualistic}.csv`
* **Table 1:** `all_runs_result_{dynamics}.csv`
*
* # TIPMOC (TIpping via Powerâ€‘law fits and MOdel Comparison)

This repository lists the code to run TIPMOC, including the code that is necessary to produce the figures and table in the paper.
When you use the code, please cite the following paper:

xxx

## Code

`explain_tipmoc.py`  Produce a schematic figure (Figure 1 in the manuscript).


`one_run_plot_using_given_data.py` Fine-tune the figures produced by `test_tipmoc_100_1.py`. It reads numerical data files generated by `test_tipmoc_100_1.py` and generates final Figures 2(a) and 2(b).

`diagnostic_analysis.py` Compute summary statistics from the simulated data produced by `test_topmoc_100_1.py`. Some output data are used for Table 1.

`plot_hatuc_scatter_dw.py` Produce diagnostic scattergrams (Figures 3(a) and 3(b)). See the first few lines of the code for the usage.

`bifu_pt_double_well.py` Determine the lower saddle-node bifurcation point of the double-well dynamical system. The obtained bifurcation point value (i.e., 3.079) is referred to in the manuscript.

`bifu_pt_mutualistic.py` Determine the collapse point of the mutualistic-interaction dynamical system. The obtained collapse point value (i.e., 0.0470) is referred to in the manuscript.

`sample-plot.py` Produce a figure showing $$\hat{V}$$ vs $$u$$ for three simulation runs with different colors (Figures 2(c) and 4).

`sample-plot-using-given-data.py` Fine-tune the figure produced by `sample-plot.py`. It reads numerical data files generated by `sample-plot.py' and generates final Figures 2(c) and 4.
