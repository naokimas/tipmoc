# TIPMOC (TIpping via Powerâ€‘law fits and MOdel Comparison)

This repository lists the code to run TIPMOC, including the code that is necessary to produce the figures and table in the paper.
When you use the code, please cite the following paper:

xxx

## Code

`explain_tipmoc.py`  Produce a schematic figure (Figure 1 in the manuscript).

`test_tipmoc_100_1.py` Run TIPMOC arbitrarily many times and generate data for Figures 2(a) and 2(b) and Table 1.

`run_double_well.py` Run the double-well dynamical system and return a sequence of ($$u$$, $$\hat{V}$$).

`run_over_harvesting.py` Run the over-harvesting models in Kefi et al., Oikos (2013) and return a sequence of ($$u$$, $$\hat{V}$$).

`run_mutualistic.py` Same for the mutualistic-interaction model on the network.

`run_ou.py` Same for the Ornstein-Uhlenbeck process.

`delta_aicc.py` Compute $$\Delta \text{AIC}_{\text{c}}$$, or the difference between AIC$$_{\text{c}}$$ for the linear and power-law fits, given a sequence of ($$u$$, $$\hat{V}$$). This function is part of TIPMOC.

`fit_powerlaw.py` Fit the specific power-law diverging function to a give sequene of ($$u$$, $$\hat{V}$$). This function is part of TIPMOC.

`one_run_plot_using_given_data.py` Fine-tune the figures produced by `test_tipmoc_100_1.py`. It reads numerical data files generated by `test_tipmoc_100_1.py` and generates final Figures 2(a) and 2(b).

`diagnostic_analysis.py` Compute summary statistics from the simulated data produced by `test_topmoc_100_1.py`. Some output data are used for Table 1.

`plot_hatuc_scatter_dw.py` Produce diagnostic scattergrams (Figures 3(a) and 3(b)). See the first few lines of the code for the usage.

`bifu_pt_double_well.py` Determine the lower saddle-node bifurcation point of the double-well dynamical system. The obtained bifurcation point value (i.e., 3.079) is referred to in the manuscript.

`bifu_pt_mutualistic.py` Determine the collapse point of the mutualistic-interaction dynamical system. The obtained collapse point value (i.e., 0.0470) is referred to in the manuscript.

`sample-plot.py` Produce a figure showing $$\hat{V}$$ vs $$u$$ for three simulation runs with different colors (Figures 2(c) and 4).

`sample-plot-using-given-data.py` Fine-tune the figure produced by `sample-plot.py`. It reads numerical data files generated by `sample-plot.py' and generates final Figures 2(c) and 4.

## Network data

`LFR.csv` The LFT network used in the simulation of the mutualistic-interaction dynamics. This network is identical to the one used in [Maclaren, Kundu & Masuda, Journal of the Royal Society Interface, 2023]([https://doi.org/10.1038/s41467-025-64975-x](https://doi.org/10.1098/rsif.2022.0743))

# Numerically simulated data

The following files contain numerically generated data used for generating the figures in the manuscript. They are in the data_for_fig folder.

`last_trial_raw_data_dw.csv` is for Figures 2(a) and 2(b).

`all_runs_result_{dw, dw_poisson, dw_poisson_colored_sigma005, overharvestingK10, lineargrazing, rosenzweig, mutualistic, ou, overharvestingK2}.csv` are for Table 1. `all_runs_result_dw.csv` is also for Figure 3.

`detection_summary-dw.csv` and `sample_variance_trials-dw.csv` are for Figure 2(c).

`detection_summary-{overharvestingK10, lineargrazing, rosenzweig, mutualistic}.csv` and `sample_variance_trials-{overharvestingK10, lineargrazing, rosenzweig, mutualistic}.csv` are for Figure 4.



